{% extends "base.html" %}

{% block title %}
<div class="primary">
<h1>
  <b>Gamma-ray Burst and Supernova Associations Project</b>
</h1>
</div>

{% endblock %}

{% block content %}
<div class="primary">
<!-- Images -->
<!-- <h2><b>Overview of Events</b></h2> -->

<div class="card-group">
  <div class="card text-center">
    <img class="card-img-top" src="/plot/e_iso">
    <div class="card-body">
      <h5 class="card-title">E$_{iso}$ distribution of the events.</h5>
      <!-- <p2 class="card-text">E$_{iso}$ distribution across the objects</p2> -->
    </div>
  </div>
  <div class="card text-center">
    <img class="card-img-top" src="/plot/z">
    <div class="card-body">
      <h5 class="card-title">Redshift distribution of the events.</h5>

    </div>
  </div>
  <div class="card text-center">
    <img class="card-img-top" src="static/stats/IcBLAssociationsNumberperyear(Bar).pdf" alt="Card image cap">
    <div class="card-body">
      <h5 class="card-title">Number of events per year (Taken from the <a href="https://www.wis-tns.org" target='_blank'
          style="color: blue">Transient Name Server</a>)</h5>
    </div>
  </div>
</div>

<!-- Forms -->
{% from "_formhelpers.html" import render_field %}
<h2>
  <b>
    Search the database by object name 
  </b> 
</h2>
<form method=post>
  <div class="form-group">
    {{ render_field(form.object_name, class="form-control", placeholder="Enter GRB or SN ID (e.g. SN1998bw or GRB200826A)") }}
    <button type="submit" class="btn btn-warning btn-lg">Search</button>
  </div>
</form>

{% with messages = get_flashed_messages(with_categories=true) %}
<!-- {% if messages %}
    <ul class=flashes> -->
{% for category, message in messages %}
<p class="error"><b>WARNING!!!</b> {{ message }}
  {% endfor %}
  </ul>
  <!-- {% endif %} -->
  {% endwith %}

<h2><b>Known Associations</b></h2>

<p>The table below displays some basic parameters for the known GRB-SN associations. If you would like to download the
  full database click <a href="{{ url_for('get_master_table')}}">here</a>. The table below only displays part of the
  data stored in the database. The download will include all information stored within the database as a .txt file. </p>

<!-- Table of all the sources -->

  <table class="table table-striped table-bordered table-sm">
    <thead>
      <tr>
        <th scope="col"><b>GRB</b></th>
        <th scope="col"><b>SN</b></th>
        <th scope="col"><b>E$_{iso}$ [ergs]</b></th>
        <th scope="col"><b>z</b></th>
        <th scope="col"><b>T$_{90}$ [sec]</b></th>
        <th scope="col"><b>M$_{Ej}$ [M$_{\odot}$]</b></th>
        <th scope="col"><b>M$_{Ni}$ [M$_{\odot}$]</b></th>
        <th scope="col"><b>E$_{p}$ [keV]</b></th>
        <th scope="col"><b>E$_{k}$ (SN) [ergs]</b></th>
      </tr>
    </thead>
		
    <tbody>
		{% for i in range(data|length) %}
		<tr>
			
			{% if numerics[i] == 1 %}
				<!-- GRB and SN have a name -->
				{% if data[i][0]!=None and data[i][1]!=None %}
				<th><a href="/GRB{{ data[i][0] }}-SN{{ data[i][1] }}" target='_blank'>{{ data[i][0] }}</th>
				<th><a href="/GRB{{ data[i][0] }}-SN{{ data[i][1] }}" target='_blank'>{{ data[i][1] }}</th>
				<!-- GRB has name -->
				{% elif data[i][0]!=None and data[i][1]==None %}
				<th><a href="/GRB{{ data[i][0] }}" target='_blank'>{{ data[i][0] }}</th>
				<th> </th>
				<!-- SN has a name -->
				{% elif data[i][0]==None and data[i][1]!=None %}
				<th> </th>
				<th><a href="/SN{{ data[i][1] }}" target='_blank'>{{ data[i][1] }}</th>
				{% endif %}
			{% else %}
				<!-- GRB and SN have a name -->
				{% if data[i][0]!=None and data[i][1]!=None %}
				<th><a href="/GRB{{ data[i][0] }}-{{ data[i][1] }}" target='_blank'>{{ data[i][0] }}</th>
				<th><a href="/GRB{{ data[i][0] }}-{{ data[i][1] }}" target='_blank'>{{ data[i][1] }}</th>
				<!-- GRB has name -->
				{% elif data[i][0]!=None and data[i][1]==None %}
				<th><a href="/GRB{{ data[i][0] }}" target='_blank'>{{ data[i][0] }}</th>
				<th> </th>
				<!-- SN has a name -->
				{% elif data[i][0]==None and data[i][1]!=None %}
				<th> </th>
				<th><a href="/{{ data[i][1] }}" target='_blank'>{{ data[i][1] }}</th>
				{% endif %}
			{% endif %}

			<!-- EISO -->
			{% if data[i][2] != None %}
			<th>{{ data[i][2] }}</th>
			{% else %}
			<th> </th>
			{% endif %}

			<!-- Z -->
			{% if data[i][3] != None %}
			<th>{{ data[i][3] }}</th>
			{% else %}
			<th> </th>
			{% endif %}

			<!-- T90 -->
			{% if data[i][4] != None %}
			<th>{{ data[i][4] }}</th>
			{% else %}
			<th> </th>
			{% endif %}

			<!-- Ejecta mass -->
			{% if data[i][5] != None %}
			<th>{{ data[i][5] }}</th>
			{% else %}
			<th> </th>
			{% endif %}

			<!-- Nickel mass -->
			{% if data[i][6] != None %}
			<th>{{ data[i][6] }}</th>
			{% else %}
			<th> </th>
			{% endif %}
			
			<!-- Epeak -->
			{% if data[i][7] != None %}
			<th>{{ data[i][7] }}</th>
			{% else %}
			<th> </th>
			{% endif %}

			<!-- Ek -->
			{% if data[i][8] != None %}
			<th>{{ data[i][8] }}</th>
			{% else %}
			<th> </th>
			{% endif %}
		</tr>
		{% endfor %}
  </tbody>
	</table>
  
</div>
{% endblock %}